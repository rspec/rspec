set -e

ROOT_DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )/.." && pwd )"
SCRIPT_DIR="${ROOT_DIR}/script"
source $SCRIPT_DIR/functions.sh

echo "Set bundle path to .bundle/gems"
bundle config set --local path '.bundle/gems'

if [[ -n "$1" ]]; then
  GEMFILE="Gemfile-${1}"
  echo "bundle install --standalone --gemfile=${GEMFILE}"
  bundle install --standalone --gemfile="${ROOT_DIR}/${GEMFILE}"
else
  echo "bundle install --standalone"
  bundle install --standalone

  echo "bundle binstubs --all --standalone"
  bundle binstubs --all --standalone
fi;
